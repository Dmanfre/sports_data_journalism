---
title: "Women's Soccer Data"
output: html_notebook
name: Dylan Manfre
---

We'll use this notebook to explore some NCAA women's soccer data and [our questions](https://docs.google.com/spreadsheets/d/1kTSrnl1URmcexIWLDMWqDnp3q-c2OS45uifnhjp10n4/edit#gid=0). First, let's load the tidyverse library:

```{r}
library(tidyverse)
```

We'll want to start with 2022 match data, which is located in [this GitHub repository](https://github.com/dwillis/NCAAWomensSoccerData). We can load the match data directly from GitHub using `read_csv`:


```{r}
matches_2022 <- read_csv("https://raw.githubusercontent.com/dwillis/NCAAWomensSoccerData/main/data/ncaa_womens_soccer_matchstats_2022.csv")

matches_2023 <- read_csv("https://raw.githubusercontent.com/dwillis/NCAAWomensSoccerData/main/data/ncaa_womens_soccer_matchstats_2023.csv")

```

Let's take a look at this data to see what it contains, using `head` and `glimpse`:

```{r}
head(matches_2022)
glimpse(matches_2022)
```

Now, onto the questions using aggregates, which means `group_by` and `summarize`:

1. How many shots in total has Maryland attempted and how many have been on goal? Calculate a percentage of shots on goal.

Maryland has attempted 164 shots and 46.9% of them have been shots on goal. 

```{r}
matches_2022 %>% 
  filter(team == "Maryland Terrapins, Terps") %>% 
  group_by(team) %>% 
  summarize(total_shots = sum(sh_att), total_quality_shots = sum(so_g)) %>% 
  mutate(percentage_quality_shots = (total_quality_shots/total_shots)*100) %>% 
  filter(total_shots > 50) %>% 
  arrange(desc(percentage_quality_shots))
 
```

2. What about the same shot stats from last season's first five games? You'll need to load the matches from 2021 - just change the season.

```{r}
matches_2021 <- read_csv("https://raw.githubusercontent.com/dwillis/NCAAWomensSoccerData/main/data/ncaa_womens_soccer_matchstats_2021.csv")
matches_2021 %>%
  filter(team == "Maryland Terrapins, Terps", date < "2021-09-05") %>%
  summarize(total_shots = sum(sh_att), total_shots_on_goal = sum(so_g)) %>%
  mutate(sh_pct = total_shots_on_goal / total_shots)
  
```


3. What about draws - Maryland started with 4 ties. Have any other teams had as many?

Notes: Theres an error in this code. But I fixed it.

63 teams have 4 ties.


```{r}
matches_2022 %>% 
  filter(outcome == "Draw") %>%
  group_by(team) %>%
  summarise(total_ties = n()) %>%
  filter(total_ties == 4 ) %>% 
  arrange(desc(total_ties)) 
```


4. How many total corner kicks has Maryland had so far and how many have its opponents have? Calculate the difference between the two totals for every team.

Maryland has 79 corner kicks. It's opponents have 77.
The code 

```{r}
matches_2022 %>% 
  filter(team == "Maryland Terrapins, Terps") %>% 
  group_by(team) %>% 
  summarize(total_corners = sum(corners), opp_corners = sum(defensive_corners)) %>% 
  mutate(difference = total_corners - opp_corners)
  
matches_2022 %>% 
  group_by(team) %>% 
  summarize(total_corners = sum(corners), opp_corners = sum(defensive_corners)) %>% 
  mutate(difference = total_corners - opp_corners) %>% 
  arrange(desc(difference))
```

## Significace Tests

Hypothesis: There is more scoring in women's soccer this seaosn than last season.

```{r}
#Add a column to both data frames that contains the total goals for each match

matches_2022 <- matches_2022 %>% 
mutate(total_goals = goals + defensive_goals)

matches_2023 <- matches_2023 %>% 
mutate(total_goals = goals + defensive_goals)
```

Does the number of total goals on average, is it higher this year than last years?

```{r}

t.test(matches_2022$total_goals, matches_2023$total_goals)

#there is a slight difference between 2022 (x) and 2023 (y) of about 0.3 goals per match and this is significant because it can.

# Teams scored slightly more than the prior year in all games and its happened across the baord instead of a handful of games. 

```
```{r}

#filtering 2022 to show only until today in 2023
#This will show early part of the season to see if there is new scoring.

matches_2022_early <- matches_2022 %>% 
filter(date < "2022-09-14")

t.test(matches_2022_early$total_goals, matches_2023$total_goals)

#This shows that they are nearly the same but 2023 still has more goals.

#During the early parts of 2023, teams scored more on average than they did a season ago. However, during the whole season, 2023 was on pace to otuscore 2022. This was happening across all teams during the 2023 seaosn. 

```

```{r}




```

