---
title: "background.qmd"
format: html
editor: visual
name: Dylan Manfre
---

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.



Story idea: I will be doing story idea No. 1 about whether having a good assist-to-turnover ratio actually leads to more wins and analyzing if it is a good measure of team success.

Questions in Canvas assignment

1) Does that data already exist? Can you get it?
2) Do you need assistance in getting it?
3) What time frame do you want/need data from?
4) Will you have to improve or augment the data in order to answer your question? If so, how?
5) Are there other examples of this kind of work (specific or general)? If so, provide them.

Response
1) The data does exist. I can use box score data and game logs from women's college basketball games. I believe I can get this through the sportsdataverse or a wehoops R package which already has the data inside of it.
2) I may need a little assistace getting the data because there will likely be multiple files that are similar but finding the right one for this analysis is essential to the project.
3) I would like to use data from last season 2022-23. I think this would be a good time frame to use because Brenda Frese talked about how having an assist-to-turnover ratio was essential to the team's success. I'm wondering if a text analysis could be a good part of this project to see exactly how many times she said the phrase "assist-to-turnover" ratio last season.
4) I don't believe there will be too much to agument. Unless the dataset does not already have an assist-to-turnover ratio column. If that is not there, I would need to create it by doing a mutate(ATo_ratio = sum(assits) / sum(Turnovers) * 100). Then I would need to calculate a linear model and 
5) Haven't found many articles outlining an analysis in the form of a narrative story but there have been smaller articles. 
https://statathlon.com/team_stats_analysing_impact/#:~:text=That%20the%20assist%20to%20turnover,is%20not%20always%20the%20rule.

```{r}
#libraries
library(tidyverse)
library(janitor)
#install.packages("wehoop")
library(wehoop)
library(tictoc)
library(ggplot2)
install.packages("ggrepel")
library(ggrepel)


```


```{r}
# loading data from wehoops library

game_boxes_with_teams <- read_csv("game_boxes_with_teams.csv")
View(game_boxes_with_teams)

```

cleaning
```{r}
#column rename

game_boxes_with_teams <- game_boxes_with_teams %>% 
  rename( team_ator = ast_tov_ratio,
          opp_ator = opp_ast_tov_ratio,
          win_loss = win)

#fiter out NAs
game_boxes_with_teams <- game_boxes_with_teams %>%
  filter(!is.na(team_ator))

#win columns
game_boxes_with_teams <- game_boxes_with_teams %>% 
  mutate(winner = ifelse(opp_pts > pts, away_team_name, home_team_name))

#make sure it worked
winner_loser <- game_boxes_with_teams %>% 
  select(home_team_name, pts, away_team_name, opp_pts, winner)

#picking columns I want
ator_only <- game_boxes_with_teams %>% 
  select(ncaa_game_id, gamedate_east, home_team_name, away_team_name, win_loss, team_ator, opp_ator, winner)

View(ator_only)
```

Lists
```{r}

big_ten <- c("Indiana", "Maryland", "Michigan", "Michigan St.", "Minnesota", "Nebraska", "Northwestern", "Ohio St.", "Penn St.", "Purdue", "Rutgers", "Illinois", "Iowa", "Wisconsin")

power_5 <- c("ACC", "Big 12", "Big Ten", "Pac-12", "SEC")


```



Hypothesis: Having an assist-to-turnover ratio over 2 leads to moe wins. 

What I want to do is see the percentage of games that had an assist to turnover ratio of a certain number and then generate a percentage of those games that resulted in wins and those that resulted in loses. 

# The average team astor is 0.9717791 I will use this number to base my filter
# The average opp astor is 0.7773279 I will use this number to base my filter of the opponents.


```{r}
game_boxes_with_teams %>%
  summarize(Average_ator = mean(team_ator),
    Average_oppAToR = mean(opp_ator)
  )

game_boxes_with_teams %>% 
filter(team_ator >= 0.97)

```
6,243 games resulted in wins with teams that had an astor over 0.97.



Number of teams with a greater ator than opponent
```{r}

game_boxes_with_teams %>% 
filter(team_ator > opp_ator) %>% 
count()
#9515

game_boxes_with_teams %>% 
filter( opp_ator > team_ator) %>% 
count()
#6052

```

I want to see how many wins each team has.

```{r}

total_wins <- game_boxes_with_teams %>% 
group_by(winner) %>% 
 summarize(count = n()) %>%  
arrange(desc(count))

#Confirm this worked.
```

I am only focused on wins. 

I want to to identify the average astor's in wins and loses.

Analysis: 
```{r}
season_ator_winners <- game_boxes_with_teams %>%
  group_by(winner) %>% 
  summarize(avg_ator = mean(team_ator),
    avg_opp_ator = mean(opp_ator)) %>% 
arrange(desc(avg_ator))


joined_season_ator_winner <- inner_join(season_ator_winners, total_wins, by = "winner")

joined_season_ator_winner <- joined_season_ator_winner %>% 
  rename(total_wins = count)

```

Also curious to see what team had the most games with an above average AToR... this could be a graph I think... use a scatter plot the code is in the textbook. 

Then look at any outliers. 

joined_season_ator_winner is a dataframe showing the number of wins and team's avg ator for the season. I want to filter this so that teams in the Big Ten are highlighted. 
```{r}
b10 <- joined_season_ator_winner %>% 
filter(winner %in% big_ten)

```

Just the big ten
```{r}
ggplot(data = joined_season_ator_winner, aes(x = total_wins, y = avg_ator)) +
  geom_point(data = b10, aes(x = total_wins, y = avg_ator)) +
  geom_text_repel(data = b10, aes(x = total_wins, y = avg_ator, label = winner)) +
  labs(title = "Team Wins vs. Average Assist to Turnover Ratio",
       x = "Total Wins",
       y = "Team Assist to Turnover Ratio")

```

Showing the big ten among everyone else. 
the lowering of the opasity was done via chat gpt
```{r}
ggplot() +
  geom_point(data = joined_season_ator_winner, aes(x = total_wins, y = avg_ator), alpha = 0.2) +
  geom_point(data = b10, aes(x = total_wins, y = avg_ator), color = "red") +
  geom_smooth(data=joined_season_ator_winner, aes(x=total_wins, y=avg_ator), method="lm") +
  labs(title = "Big Ten Wins vs. Average Assist to Turnover Ratio",
       x = "Total Wins",
       y = "Team Assist to Turnover Ratio") +
  geom_text_repel(data = b10, aes(x = total_wins, y = avg_ator, label = winner))

```
We see a left to right line here climbing up suggesting that there is a relationship. Creating the model 
```{r}

model1 <- lm(total_wins ~ avg_ator, data = joined_season_ator_winner)
summary(model1)

```


Exploration and explaination

- Using the model, we learn that there is some sort of relationship because there is a lower p-value, the adjusted R squared number is around 0.08 which shows there is some relationship but it may not be as strongly correlated to the number of wins a team has. The residual standard of error is is 7.0 which means this is a good comparison.  

Some further things I'm curious about are if having a certain astor could predict the number of wins a team could get. Essentially saying "having an astor over 0.7 for X games should result in X wins" 

This may be a bit too complex to analyze. But could also be an obvious question that I may want to answer but dont know hwo to at this moment.

Another question
- Could I make a list of players' assist to turn over ratio and then make a beesworm plot (yes I looked ahead in the book) to find how point guards from a certain confernece ranked in the category? Maybe say Eliza Pinzan had a better Assist to turnover ratio in home games vs Aaway games. 


Refining the data for the assignment due Oct. 22.

comparing to the SEC
```{r}
#Southeastern Conference
sec_teams <- c("Alabama", "Arkansas", "Auburn", "Florida", "Georgia", "Kentucky", "LSU", "Mississippi St.", "Missouri", "Ole Miss", "South Carolina", "Tennessee", "Texas A&M", "Vanderbilt")

sec <- joined_season_ator_winner %>% 
filter(winner %in% sec_teams)

# ACC
acc_teams <- c(
  "Boston College", "Clemson", "Duke", "Florida St.", "Georgia Tech", "Louisville", "Miami (FL)", "North Carolina", "NC State", "Pittsburgh", "Syracuse", "Virginia", "Virginia Tech", "Wake Forest")

acc <- joined_season_ator_winner %>% 
filter(winner %in% acc_teams)

# Big 12
 Big12 = c(
    "Baylor", "Iowa State", "Kansas", "Kansas St.", "Oklahoma",
    "Oklahoma St.", "TCU", "Texas", "Texas Tech", "West Virginia", "BYU", "Cincinnati", "UCF", "Houston", "Iowa St.")

 Big12 <- joined_season_ator_winner %>% 
filter(winner %in% Big12)
 
#Pac 12
  Pac12 = c(
    "Arizona", "Arizona St.", "California", "Colorado", "Oregon",
    "Oregon St.", "Stanford", "UCLA", "Southern California", "Utah", "Washington", "Washington St."
  )
  
  Pac12 <- joined_season_ator_winner %>% 
filter(winner %in% Pac12)

  conferences_ator <- bind_rows(sec, b10, acc, Big12, Pac12)
  view(conferences_ator)
  
  #Creating the confernece column
  conferences_ator <- conferences_ator %>% 
  mutate(conference = case_when(
    winner %in% acc_teams ~ "ACC",
    winner %in% big_ten ~ "Big Ten",
    winner %in% sec_teams ~ "SEC",
    winner %in% Pac12 ~ "Pac-12",
    winner %in% Big12 ~ "Big 12",
    TRUE ~ winner
  ))
```

Each conferncee avg ator
```{r}
each_conf_ator <- conferences_ator %>% 
group_by(conference) %>% 
  summarize(avg_ator = mean(avg_ator),
            avg_opp_ator = mean(avg_opp_ator)) %>% 
  mutate(difference = avg_ator - avg_opp_ator) %>% 
  arrange(desc(avg_ator))
```
It's a close race but teams in the Pac-12 had the highest ator last season. The Big Ten had the second highest. There are many talented guards in the Pac-12 and this is something I can look further into later on. I'm curious if there would be any centers who had a particularly high ator or non-guards.

scatter plot of powr five teams
```{r}

b10vp5_ator <- ggplot() +
  geom_point(data = conferences_ator, aes(x = total_wins, y = avg_ator), alpha = 0.2) +
  geom_point(data = b10, aes(x = total_wins, y = avg_ator), color = "red") +
  geom_smooth(data=conferences_ator, aes(x=total_wins, y=avg_ator), method="lm") +
  labs(title = "Big Ten Wins vs. Power 5 teams Average Assist to Turnover Ratio",
       x = "Total Wins",
       y = "Team Assist to Turnover Ratio")
  geom_text_repel(data = b10, aes(x = total_wins, y = avg_ator, label = winner))


```
The results of this scatter plot are that Big 10 teams are still pretty spread out but many of them have a high ator. Iowa was the only Big Ten team with over 30 wins 


